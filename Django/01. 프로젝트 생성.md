# 1. 시작하기

프레임워크를 활용하여 웹서비스를 만드는 것은 마치 프렌차이즈를 이용해서 카페를 차리는 것과 같다. 기본적인 구조나 필요한 코드들은 프레임워크가 제공하니 좋은 웹 서비스를 만드는 것에 집중하면 된다.

Django의 기본 구조는 데이터를 관리하는 `Model`, 사용자가 보는 화면인 `Template`, 중간 관리자인 `View`를 의미한다. 특히 `View`는 MVC 구조에서 Controller에 가까운 역할을 한다.

<img src="images/image 001.png"/>

urls를 받아 해당하는 `View`가 받는다. 들어오는 모든 요청은 `View`가 관리하며 요청에 대한 수행을 `Model`에게 넘어가 수행한다. `Model`에게 받은 정보를 `View`가 받아 `Templates`으로 넘겨 사용자가 원하는 정보를 담고 있는 html 파일을 보여준다.


## 1.1 프로젝트 생성

윈도우 환경에서 하기위해서는 PyCharm을 통해 간단하게 Django 프로젝트를 생성할 수 있으나 리눅스 환경에서는 다음과 같은 절차에 따라 프로젝트를 생성해야한다.

본 설명은 c9 환경에서 진행하였다.

1. 프로젝트 진행할 폴더 생성 [TEST]
2. 해당 폴더로 이동 (cd TEST)
3. 가상 환경 설정
   - pyenv virtualenv 3.6.7 [가상환경 이름]
   - pyenv local [가상환경 이름]
4. `django` 설치
   - `pip install django`

5. Django 프로젝트 test 생성
    - `django-admin stargproject text .`

c9과 같은 클라우드에서 작업하는 것이 아니라면 먼저 pyenv를 설치해야한다. 

**pyenv**는 현업에서는 다양한 python 버전을 고려해야하기 때문에 이를 위한 python 버전관리 툴인 pyenv를 설치해야한다. 현업에서는 항상 python이 최신 버전을 사용하는 것이 아니라 다양한 버전이 사용되기 때문에 f-string의 사용가능 여부(3.6 이상 가능) 등의 버전마다의 특징을 알고 있어야 한다.

```bash
$ git clone https://github.com/pyenv/pyenv.git ~/.pyenv
$ echo 'export PYENV_ROOT="$HOME/.pyenv"' >> ~/.bashrc
$ echo 'export PATH="$PYENV_ROOT/bin:$PATH"' >> ~/.bashrc
$ echo -e 'if command -v pyenv 1>/dev/null 2>&1; then\n  eval "$(pyenv init -)"\nfi' >> ~/.bashrc
$ exec "$SHELL"

$ git clone https://github.com/pyenv/pyenv-virtualenv.git $(pyenv root)/plugins/pyenv-virtualenv
$ echo 'eval "$(pyenv virtualenv-init -)"' >> ~/.bashrc
$ exec "$SHELL"

$ pyenv install 3.6.7
```

`pyenv global 3.6.7`처럼 입력하면 해당 버전(예:3.6.7)으로 변경할 수있다.

이후 bash에서 명령어를 다음과 같이 작성한다.

```bash
$ mkdir TEST
$ cd TEST
$ pyenv virtualenv 3.6.7 intro-venv
$ pyenv local intro-venv
$ pip install django
$ django-admin startproject intro .
```

`pyenv local intro-venv` 는 해당 폴더(TEST)에 들어가면 자동으로 가상환경으로 들어가겠끔 설정해준다.

`django-admin startproject`으로 프로젝트를 생성하고 나면 다음과 같은 구조로 파일이 생성된다.

<img src="images/image 002.png"/>

이제 `intro`라는 프로젝트 폴더와 python 파일들이 생성된 것을 확인할 수 있다.

자주 건들게 되는 파일은 `urls.py`과 `views.py`이다. 

`manage.py`는 따로 건들지 않고 주로 콘솔 창에서 명령어로 많이 다루게 된다.


## 1.2 환경 설정

설정을 위해 `setting.py`를 열어본다

*intro/settings.py*

```python
#...
# SECURITY WARNING: don't run with debug turned on in production!
DEBUG = True

ALLOWED_HOSTS = ["django-horangapple.c9users.io"] # '*'로 입력 가능

#...
LANGUAGE_CODE = 'ko-kr'  # default : 'en-us'

TIME_ZONE = 'Asia/Seoul' # default : 'UTC'

USE_I18N = True

USE_L10N = True

USE_TZ = True

#...
```

c9의 경우 `프로젝트 이름-계정.c9users.io`이나 `'*'`를 `ALLOWED_HOSTS`의 [] 안에 입력한다.

`LANGUAGE_CODE = 'en-us'`를 `ko-kr`로, `TIME_ZONE = 'UTC'`를 `Asia/Seoul`로 바꿔준다.

`USE_I18N`는 국제화 설정으로 이 값이 False이면 Admin 페이지의 언어가 LANGUAGE_CODE와 상관 없이 영어로만 설정이 된다.

## 1.3 app 생성

프로젝트 생성이 끝났다면 이제 app을 만들어보자.

```bash
$ python manage.py startapp pages
```

`pages`라는 app을 만들어보면 폴더 한 개가 생성된다.

<img src="images/image 003.png"/>

`apps.py`는 잘 안쓰이지만 view를 직접 다루는 `views.py`를 많이 다루게 된다.


*intro/settings.py*

```python
#...
# Application definition

INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'pages.apps.PagesConfig', # 그냥 'pages'라고 입력해도 된다.
]
#...
```

app을 설치하게 되면 `settings.py`로 가서 `pages.apps.PagesConfig`를 입력한다. `pages.apps.PagesConfig`은 `pages/apps.py`에 있는 class `PagesConfig`을 지칭하는 것이며 pages app에 대한 정보를 제공한다. 물론 간단하게 app 이름만 입력해도 설정이 된다. 

여기까지가 프로젝트 생성 및 app 생성 과정이고 이제 본격적으로 개발을 시작한다.